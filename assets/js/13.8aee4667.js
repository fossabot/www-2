(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{389:function(e,t,s){"use strict";s.r(t);var a=s(2),n=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("p",[e._v("OpenProject is an open source web-based project administration tool and Docker is a tool for downloading software "),s("em",[e._v("images")]),e._v(" for running them inside "),s("em",[e._v("containers")]),e._v(". Those containers could be set up very quickly without the hassle that comes with the installation of regular, native applications (e.g. setting the right permissions, bloat the file system with lots of files everywhere, messing up your configuration).")]),e._v(" "),s("p",[e._v("Docker also makes it straightforward to completely remove images and containers, leaving no garbage on your system after removal. And, as an extra, Docker also allows to run multiple instances of the same image(s) simultaneously.")]),e._v(" "),s("p",[e._v("This article guides you through installing OpenProject in Docker in an easy and professional way, so that you could set it up quickly without headaches and take your next project(s) to a new level.")]),e._v(" "),s("h2",{attrs:{id:"step-1-setting-up-docker-io"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-1-setting-up-docker-io"}},[e._v("#")]),e._v(" Step 1: Setting up Docker.io")]),e._v(" "),s("p",[e._v("First thing you'll need to do is to install Docker")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" docker.io\n")])])]),s("p",[e._v("Then, add your current user to the "),s("code",[e._v("docker")]),e._v(" group")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" gpasswd -a "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("$USER")]),e._v(" docker "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" newgrp docker\n")])])]),s("p",[e._v("After that, try to run the "),s("code",[e._v("hello-world")]),e._v(" docker-image to test if all permissions are set up correctly and your Docker installation works")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[e._v("docker run hello-world\n")])])]),s("p",[e._v("Docker should begin downloading the "),s("code",[e._v("hello-world")]),e._v(" image and run it immediately, and shows the following output:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("Hello from Docker!\nThis message shows that your installation appears to be working correctly.\n\n(...)\n")])])]),s("p",[e._v("Nice, it works.")]),e._v(" "),s("h2",{attrs:{id:"step-2-the-installation-of-openproject"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-2-the-installation-of-openproject"}},[e._v("#")]),e._v(" Step 2: The installation of OpenProject")]),e._v(" "),s("h3",{attrs:{id:"creating-directories-and-setting-the-correct-permissions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#creating-directories-and-setting-the-correct-permissions"}},[e._v("#")]),e._v(" Creating directories and setting the correct permissions")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("mkdir")]),e._v(" -p /var/lib/openproject/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("pgdata,logs,static"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),s("p",[e._v("Under *nix systems, permissions are king.")]),e._v(" "),s("p",[e._v("For a safe environment, it is recommended to change the permissions to make sure that only privileged users and applications have access to the files. The following commands will lock down access to your current user and users that are part of the "),s("code",[e._v("docker")]),e._v(" group.")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("chown")]),e._v(" -R "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[e._v("$USER")]),e._v(":docker /var/lib/openproject/ "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("&&")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("chmod")]),e._v(" -R "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("770")]),e._v(" /var/lib/openproject/\n")])])]),s("p",[e._v("To check the permissions of a directory, one would use the following command:")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("ls")]),e._v(" /var/lib/openproject/ -la\n")])])]),s("p",[e._v("It should output something like this:")]),e._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("drwxrwx---  5 geekyb docker 4096 aug 16 15:01 .\ndrwxr-xr-x 73 root   root   4096 aug 16 15:01 ..\ndrwxrwx---  2 geekyb docker 4096 aug 16 15:01 logs\ndrwxrwx---  2 geekyb docker 4096 aug 16 15:01 pgdata\ndrwxrwx---  2 geekyb docker 4096 aug 16 15:01 static\n")])])]),s("p",[e._v("Where it shows with that the directory"),s("code",[e._v("/var/lib/openproject")]),e._v(" and the underlying ones are owned by you (user "),s("code",[e._v("geekyb")]),e._v(" in this example) and the "),s("code",[e._v("docker")]),e._v(" group and all permissions are set up correctly ("),s("code",[e._v("rwxrwx---")]),e._v(").")]),e._v(" "),s("p",[e._v("The parent directory "),s("code",[e._v("..")]),e._v(" is owned by the "),s("code",[e._v("root")]),e._v(" user.")]),e._v(" "),s("h3",{attrs:{id:"setting-up-the-environment-variables"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-the-environment-variables"}},[e._v("#")]),e._v(" Setting up the environment variables")]),e._v(" "),s("p",[e._v("Now that the directories are created with the correct permissions, it is time to set up environment variables. These tell the container which configuration state is to be used.")]),e._v(" "),s("p",[e._v("The first environmental variable is a secret key base. That could be chosen by hand, but is much more secure to generate one programmatically by using openssl.")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("printf")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[e._v("'SECRET_KEY_BASE=%16s"),s("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[e._v("\\n")]),e._v("'")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[s("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),e._v("openssl rand -hex "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("16")]),s("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">>")]),e._v(" /var/lib/openproject/.env\n")])])]),s("p",[e._v("That's all you need to do to get it working.")]),e._v(" "),s("h3",{attrs:{id:"setting-up-outgoing-e-mail-optional"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#setting-up-outgoing-e-mail-optional"}},[e._v("#")]),e._v(" Setting up outgoing e-mail (optional)")]),e._v(" "),s("p",[e._v("If you want to send outgoing e-mail from your OpenProject installation, you should open the environment variables file and add some additional variables.")]),e._v(" "),s("p",[e._v("Open the "),s("code",[e._v(".env")]),e._v(" file, for example, by using nano...")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("nano")]),e._v(" /var/lib/openproject/.env\n")])])]),s("p",[e._v("Add the following lines after "),s("code",[e._v("SECRET_KEY_BASE")]),e._v("...")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("EMAIL_DELIVERY_METHOD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("smtp\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("SMTP_ADDRESS")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("smtp.sendgrid.net\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("SMTP_PORT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("587")]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("SMTP_DOMAIN")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("your-domain-name-here.example.com\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("SMTP_AUTHENTICATION")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("login\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("SMTP_ENABLE_STARTTLS_AUTO")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("true\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("SMTP_USER_NAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"apikey"')]),e._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("SMTP_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[e._v('"SG.XXXXXXXXXXXXX-XXXXXXXX.XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"')]),e._v("\n")])])]),s("p",[e._v("Where you would replace the values with ones from your own SMTP provider. The example above is based on SendGrid.")]),e._v(" "),s("h2",{attrs:{id:"step-3-running-openproject"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-3-running-openproject"}},[e._v("#")]),e._v(" Step 3: Running OpenProject")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" docker run -d -p "),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("8080")]),e._v(":80 --name openproject "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  -v /var/lib/openproject/pgdata:/var/lib/postgresql/9.6/main "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  -v /var/lib/openproject/logs:/var/log/supervisor "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  -v /var/lib/openproject/static:/var/db/openproject "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  --env-file /var/lib/openproject/.env --restart"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("unless-stopped "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n  openproject/community:8\n")])])]),s("p",[e._v("The next step is to open up a browser, pointing to "),s("code",[e._v("http://localhost:8080/")]),e._v(". The default username is "),s("code",[e._v("admin")]),e._v(" and password "),s("code",[e._v("admin")]),e._v(", OpenProject will ask you to change these upon the first login.")]),e._v(" "),s("h2",{attrs:{id:"step-4-automatically-starting-openproject"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-4-automatically-starting-openproject"}},[e._v("#")]),e._v(" Step 4: Automatically starting OpenProject")]),e._v(" "),s("p",[e._v("The next step is to automatically start OpenProject")]),e._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("nano")]),e._v(" /etc/systemd/system/openproject.service\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("[Unit]\nDescription=Start OpenProject Docker Container on boot\n\n[Service]\nType=oneshot\nExecStart=/usr/bin/docker start openproject\nExecStop=/usr/bin/docker stop openproject\nRemainAfterExit=yes\n\n[Install]\nWantedBy=multi-user.target\n")])])]),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" systemctl "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("enable")]),e._v(" openproject.service\n")])])]),s("h2",{attrs:{id:"next-steps"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#next-steps"}},[e._v("#")]),e._v(" Next Steps...")]),e._v(" "),s("p",[e._v("The next step is to improve your installation.")]),e._v(" "),s("ul",[s("li",[e._v("Create a reverse proxy (nginx is easier than Apache, but both will work)")]),e._v(" "),s("li",[e._v("Change name of the sender (e.g. to "),s("code",[e._v("Company X Project Management")]),e._v(")")]),e._v(" "),s("li",[e._v("Change the URL "),s("code",[e._v("http://localhost:3000")]),e._v(" in the settings (and don't choose HTTPS, it will break your configuration)")])]),e._v(" "),s("p",[e._v("Note: If you have set up outgoing e-mail, the recipients will receive emails containing "),s("code",[e._v("http://localhost:3000")])]),e._v(" "),s("h1",{attrs:{id:"removal"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#removal"}},[e._v("#")]),e._v(" Removal")]),e._v(" "),s("p",[e._v("Not happy with OpenProject? Removal is easy.")]),e._v(" "),s("ol",[s("li",[s("code",[e._v("docker container stop openproject")])]),e._v(" "),s("li",[s("code",[e._v("docker container rm openproject")])]),e._v(" "),s("li",[s("code",[e._v("sudo rm -r /var/lib/openproject/")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);